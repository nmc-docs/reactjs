"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[833],{3905:(n,e,t)=>{t.d(e,{Zo:()=>p,kt:()=>f});var r=t(7294);function c(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function a(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function o(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?a(Object(t),!0).forEach((function(e){c(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function i(n,e){if(null==n)return{};var t,r,c=function(n,e){if(null==n)return{};var t,r,c={},a=Object.keys(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||(c[t]=n[t]);return c}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(c[t]=n[t])}return c}var l=r.createContext({}),h=function(n){var e=r.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):o(o({},e),n)),t},p=function(n){var e=h(n.components);return r.createElement(l.Provider,{value:e},n.children)},s="mdxType",u={inlineCode:"code",wrapper:function(n){var e=n.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(n,e){var t=n.components,c=n.mdxType,a=n.originalType,l=n.parentName,p=i(n,["components","mdxType","originalType","parentName"]),s=h(t),m=c,f=s["".concat(l,".").concat(m)]||s[m]||u[m]||a;return t?r.createElement(f,o(o({ref:e},p),{},{components:t})):r.createElement(f,o({ref:e},p))}));function f(n,e){var t=arguments,c=e&&e.mdxType;if("string"==typeof n||c){var a=t.length,o=new Array(a);o[0]=m;var i={};for(var l in e)hasOwnProperty.call(e,l)&&(i[l]=e[l]);i.originalType=n,i[s]="string"==typeof n?n:c,o[1]=i;for(var h=2;h<a;h++)o[h]=t[h];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},5752:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>h});var r=t(7462),c=(t(7294),t(3905));const a={sidebar_position:3},o="useEffect()",i={unversionedId:"react-hooks/useEffect",id:"react-hooks/useEffect",title:"useEffect()",description:"Tr\u01b0\u1edbc khi v\xe0o kh\xe1i ni\u1ec7m Effects , ta c\u1ea7n ph\xe2n bi\u1ec7t tr\u01b0\u1edbc hai lo\u1ea1i logic \u1edf b\xean trong m\u1ed9t component:",source:"@site/docs/react-hooks/useEffect.md",sourceDirName:"react-hooks",slug:"/react-hooks/useEffect",permalink:"/reactjs/react-hooks/useEffect",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"useState()",permalink:"/reactjs/react-hooks/useState"},next:{title:"useRef()",permalink:"/reactjs/react-hooks/useRef"}},l={},h=[{value:"Khai b\xe1o",id:"khai-b\xe1o",level:2},{value:"Ch\u1ec9 \u0111\u1ecbnh Effect dependencies",id:"ch\u1ec9-\u0111\u1ecbnh-effect-dependencies",level:2},{value:"Cleanup function",id:"cleanup-function",level:2}],p={toc:h},s="wrapper";function u(n){let{components:e,...a}=n;return(0,c.kt)(s,(0,r.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,c.kt)("h1",{id:"useeffect"},"useEffect()"),(0,c.kt)("p",null,"Tr\u01b0\u1edbc khi v\xe0o kh\xe1i ni\u1ec7m ",(0,c.kt)("strong",{parentName:"p"},"Effects")," , ta c\u1ea7n ph\xe2n bi\u1ec7t tr\u01b0\u1edbc hai lo\u1ea1i logic \u1edf b\xean trong m\u1ed9t component:"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Rendering code")," (th\u01b0\u1eddng \u0111\u01b0\u1ee3c g\u1ecdi l\xe0 ph\u1ea7n giao di\u1ec7n): n\u1eb1m \u1edf c\u1ea5p cao nh\u1ea5t c\u1ee7a component. \u0110\xe2y l\xe0 n\u01a1i b\u1ea1n l\u1ea5y c\xe1c ",(0,c.kt)("inlineCode",{parentName:"li"},"props"),", ",(0,c.kt)("inlineCode",{parentName:"li"},"state")," v\xe0 bi\u1ebfn \u0111\u1ed5i ch\xfang, tr\u1ea3 v\u1ec1 ",(0,c.kt)("strong",{parentName:"li"},"JSX")," m\xe0 b\u1ea1n mu\u1ed1n hi\u1ec3n th\u1ecb l\xean tr\xean m\xe0n h\xecnh tr\xecnh duy\u1ec7t."),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Event handlers")," (tr\xecnh x\u1eed l\xfd s\u1ef1 ki\u1ec7n): l\xe0 c\xe1c h\xe0m l\u1ed3ng nhau b\xean trong component \u0111\u1ec3 x\u1eed l\xfd t\u01b0\u01a1ng t\xe1c c\u1ee7a ng\u01b0\u1eddi d\xf9ng. V\xed d\u1ee5 nh\u01b0 s\u1ef1 ki\u1ec7n nh\u1eadp v\xe0o \xf4 input, click v\xe0o button,\u2026")),(0,c.kt)("admonition",{type:"note"},(0,c.kt)("p",{parentName:"admonition"},"\u2757\ufe0f\u0110\xf4i khi hai lo\u1ea1i tr\xean l\xe0 ch\u01b0a \u0111\u1ee7. V\xed d\u1ee5 nh\u01b0 m\u1ed9t ChatRoom (ph\xf2ng chat) ph\u1ea3i k\u1ebft n\u1ed1i v\u1edbi m\xe1y ch\u1ee7 tr\xf2 chuy\u1ec7n b\u1ea5t c\u1ee9 khi n\xe0o n\xf3 hi\u1ec3n th\u1ecb tr\xean m\xe0n h\xecnh. Vi\u1ec7c k\u1ebft n\u1ed1i m\xe1y ch\u1ee7 n\xe0y kh\xf4ng th\u1ec3 x\u1ea3y ra trong qu\xe1 tr\xecnh hi\u1ec3n th\u1ecb, v\xe0 kh\xf4ng c\xf3 s\u1ef1 ki\u1ec7n c\u1ee5 th\u1ec3 n\xe0o gi\u1ed1ng nh\u01b0 m\u1ed9t c\xfa nh\u1ea5p chu\u1ed9t khi\u1ebfn ChatRoom \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb")),(0,c.kt)("p",null,"\ud83d\udd11 ",(0,c.kt)("strong",{parentName:"p"},"Effects")," cho ph\xe9p b\u1ea1n ch\u1ec9 \u0111\u1ecbnh c\xe1c ",(0,c.kt)("strong",{parentName:"p"},"side effects")," do ch\xednh n\xf3 g\xe2y ra, ch\u1ee9 kh\xf4ng ph\u1ea3i do m\u1ed9t s\u1ef1 ki\u1ec7n c\u1ee5 th\u1ec3. G\u1eedi tin nh\u1eafn trong cu\u1ed9c tr\xf2 chuy\u1ec7n l\xe0 m\u1ed9t s\u1ef1 ki\u1ec7n v\xec n\xf3 tr\u1ef1c ti\u1ebfp do ng\u01b0\u1eddi d\xf9ng nh\u1ea5p v\xe0o m\u1ed9t n\xfat c\u1ee5 th\u1ec3 g\xe2y ra. Tuy nhi\xean, thi\u1ebft l\u1eadp k\u1ebft n\u1ed1i m\xe1y ch\u1ee7 l\xe0 m\u1ed9t ",(0,c.kt)("strong",{parentName:"p"},"Effects")," v\xec n\xf3 c\u1ea7n ph\u1ea3i x\u1ea3y ra b\u1ea5t k\u1ec3 t\u01b0\u01a1ng t\xe1c n\xe0o khi\u1ebfn component xu\u1ea5t hi\u1ec7n. ",(0,c.kt)("strong",{parentName:"p"},"Effects")," ch\u1ea1y \u1edf cu\u1ed1i qu\xe1 tr\xecnh render sau khi m\xe0n h\xecnh c\u1eadp nh\u1eadt. \u0110\xe2y l\xe0 th\u1eddi \u0111i\u1ec3m t\u1ed1t \u0111\u1ec3 \u0111\u1ed3ng b\u1ed9 h\xf3a c\xe1c th\xe0nh ph\u1ea7n React v\u1edbi m\u1ed9t s\u1ed1 h\u1ec7 th\u1ed1ng b\xean ngo\xe0i (nh\u01b0 m\u1ea1ng ho\u1eb7c th\u01b0 vi\u1ec7n c\u1ee7a b\xean th\u1ee9 ba)"),(0,c.kt)("p",null,"\u26a0 L\u01b0u \xfd r\u1eb1ng ",(0,c.kt)("strong",{parentName:"p"},"Effects")," th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \u201ct\xe1ch\u201d kh\u1ecfi \u0111o\u1ea1n m\xe3 React v\xe0 \u0111\u1ed3ng b\u1ed9 h\xf3a v\u1edbi m\u1ed9t s\u1ed1 h\u1ec7 th\u1ed1ng b\xean ngo\xe0i. \u0110i\u1ec1u n\xe0y bao g\u1ed3m c\xe1c API c\u1ee7a tr\xecnh duy\u1ec7t, ti\u1ec7n \xedch con c\u1ee7a b\xean th\u1ee9 ba, m\u1ea1ng..."),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"\u0110\u1ec3 s\u1eed d\u1ee5ng ",(0,c.kt)("strong",{parentName:"li"},"Effects")," , ta c\u1ea7n l\xe0m theo 3 b\u01b0\u1edbc:",(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Khai b\xe1o m\u1ed9t Effect")," : theo m\u1eb7c \u0111\u1ecbnh, ",(0,c.kt)("strong",{parentName:"li"},"Effect")," s\u1ebd ch\u1ea1y sau m\u1ed7i l\u1ea7n render."),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Ch\u1ec9 \u0111\u1ecbnh Effect dependencies")," : h\u1ea7u h\u1ebft c\xe1c ",(0,c.kt)("strong",{parentName:"li"},"Effect")," s\u1ebd ch\u1ea1y l\u1ea1i khi c\u1ea7n thi\u1ebft thay v\xec ch\u1ea1y l\u1ea1i sau m\u1ed7i l\u1ea7n component re-render. V\xed d\u1ee5 ch\u1ec9 g\u1ecdi l\u1ea1i API sau m\u1ed7i l\u1ea7n pages trong \u0111\u01b0\u1eddng d\u1eabn thay \u0111\u1ed5i"),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Th\xeam h\xe0m cleanup (n\u1ebfu c\u1ea7n)")," : m\u1ed9t s\u1ed1 ",(0,c.kt)("strong",{parentName:"li"},"Effect")," c\u1ea7n ch\u1ec9 \u0111\u1ecbnh vi\u1ec7c d\u1eebng/ho\xe0n t\xe1c th\u1ef1c hi\u1ec7n. V\xed d\u1ee5: \u201cconnet\u201dc\u1ea7n \u201cdisconnet\u201d,\u2026")))),(0,c.kt)("h2",{id:"khai-b\xe1o"},"Khai b\xe1o"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},'import { useEffect } from "react";\nfunction MyComponent() {\n  useEffect(() => {\n    // Code here will run after *every* render\n  });\n  return <div />;\n}\n')),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"M\u1ed7i khi component \u0111\u01b0\u1ee3c render, React s\u1ebd c\u1eadp nh\u1eadt hi\u1ec3n th\u1ecb tr\xean m\xe0n h\xecnh ",(0,c.kt)("strong",{parentName:"li"},"TR\u01af\u1edaC")," , v\xe0 ch\u1ea1y \u0111o\u1ea1n m\xe3 trong useEffect ",(0,c.kt)("strong",{parentName:"li"},"SAU")," . N\xf3i c\xe1ch kh\xe1c, ",(0,c.kt)("inlineCode",{parentName:"li"},"useEffect")," \u201ctr\xec ho\xe3n\u201d m\u1ed9t \u0111o\u1ea1n m\xe3 ch\u1ea1y cho \u0111\u1ebfn khi render \u0111\xf3 \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb tr\xean m\xe0n h\xecnh")),(0,c.kt)("h2",{id:"ch\u1ec9-\u0111\u1ecbnh-effect-dependencies"},"Ch\u1ec9 \u0111\u1ecbnh Effect dependencies"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Theo m\u1eb7c \u0111\u1ecbnh, ",(0,c.kt)("strong",{parentName:"li"},"Effect")," ch\u1ea1y sau m\u1ed7i l\u1ea7n render. Th\xf4ng th\u01b0\u1eddng, \u0111\xe2y kh\xf4ng ph\u1ea3i l\xe0 \u0111i\u1ec1u ta mu\u1ed1n, \u0111\xf4i khi ta mu\u1ed1n ",(0,c.kt)("strong",{parentName:"li"},"Effect")," ch\u1ea1y l\u1ea1i d\u1ef1a tr\xean c\xe1c y\u1ebfu t\u1ed1 thay \u0111\u1ed5i kh\xe1c. V\xed d\u1ee5 ",(0,c.kt)("strong",{parentName:"li"},"Effect")," ch\u1ec9 ch\u1ea1y khi bi\u1ebfn \u201ca\u201d thay \u0111\u1ed5i so v\u1edbi l\u1ea7n tr\u01b0\u1edbc \u0111\xf3,\u2026 V\xec v\u1eady, ",(0,c.kt)("strong",{parentName:"li"},"Effect")," cho ph\xe9p ta truy\u1ec1n v\xe0o ",(0,c.kt)("inlineCode",{parentName:"li"},"useEffect")," tham s\u1ed1 th\u1ee9 2")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},'useEffect(() => {\n  /* This code runs every render */\n})\n\nuseEffect(() => {\n  /* This code runs only on mounted (when the component appears) */\n}, [])\n\nuseEffect(() => {\n  /* This code run on mounted and if "a" or "b" has changed since the last render */\n}, [a, b,...])\n')),(0,c.kt)("p",null,"\u26a0 L\u01b0u \xfd r\u1eb1ng \u0111\xf4i khi ch\xfang ta kh\xf4ng th\u1ec3 t\xf9y \xfd ch\u1ecdn ",(0,c.kt)("inlineCode",{parentName:"p"},"dependencies"),". N\xf3 c\xf2n ph\u1ee5 thu\u1ed9c v\xe0o bi\u1ebfn \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong h\xe0m ",(0,c.kt)("inlineCode",{parentName:"p"},"useEffect")," . V\xed d\u1ee5:"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},"useEffect(() => {\n  if (shouldFocus) {\n    ref.current.focus();\n  }\n}, []);\n")),(0,c.kt)("admonition",{type:"note"},(0,c.kt)("p",{parentName:"admonition"},"\u0110o\u1ea1n code tr\xean s\u1ebd b\xe1o l\u1ed7i do ta \u0111ang s\u1eed d\u1ee5ng ",(0,c.kt)("inlineCode",{parentName:"p"},"shouldFocus")," b\xean trong ",(0,c.kt)("inlineCode",{parentName:"p"},"useEffect"),", \u0111\u1ec3 kh\u1eafc ph\u1ee5c, ta ph\u1ea3i th\xeam ",(0,c.kt)("inlineCode",{parentName:"p"},"shouldFocus")," l\xe0m ",(0,c.kt)("inlineCode",{parentName:"p"},"dependencies"))),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},"useEffect(() => {\n  if (shouldFocus) {\n    ref.current.focus();\n  }\n}, [shouldFocus]);\n")),(0,c.kt)("h2",{id:"cleanup-function"},"Cleanup function"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"Xem x\xe9t m\u1ed9t v\xed d\u1ee5 sau \u0111\xe2y:")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},"export default function ChatRoom() {\n  useEffect(() => {\n    const connection = createConnection();\n    connection.connect();\n  }, []);\n  return <h1>Welcome to the chat!</h1>;\n}\n")),(0,c.kt)("admonition",{type:"caution"},(0,c.kt)("p",{parentName:"admonition"},"Ta c\xf3 m\u1ed9t component \u201cChatRoom\u201d. Khi component n\xe0y \u201cmounted\u201d, n\xf3 s\u1ebd g\u1ecdi ",(0,c.kt)("inlineCode",{parentName:"p"},"connection.connect()")," (1). Sau \u0111\xf3 gi\u1ea3 s\u1eed ng\u01b0\u1eddi d\xf9ng \u0111i \u0111\u1ebfn trang \u201cSetting\u201d, component \u201cChatRoom\u201d s\u1ebd \u201cunmounted\u201d. Cu\u1ed1i c\xf9ng, ng\u01b0\u1eddi d\xf9ng quay tr\u1edf l\u1ea1i \u201cChatRoom\u201d v\xe0 component n\xe0y l\u1ea1i m\u1ed9t l\u1ea7n n\u1eefa \u201cmounted\u201d v\xe0 ",(0,c.kt)("inlineCode",{parentName:"p"},"connection.connect()")," (2) s\u1ebd \u0111\u01b0\u1ee3c g\u1ecdi l\u1ea1i, \u0111i\u1ec1u n\xe0y s\u1ebd thi\u1ebft l\u1eadp k\u1ebft n\u1ed1i th\u1ee9 hai \u2013 nh\u01b0ng k\u1ebft n\u1ed1i \u0111\u1ea7u ti\xean s\u1ebd kh\xf4ng bao gi\u1edd b\u1ecb ph\xe1 h\u1ee7y. Do \u0111\xf3, khi ng\u01b0\u1eddi d\xf9ng \u0111i\u1ec1u h\u01b0\u1edbng nhi\u1ec1u l\u1ea7n, c\xe1c k\u1ebft n\u1ed1i s\u1ebd li\xean t\u1ee5c \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp l\u1ea1i, d\u1eabn \u0111\u1ebfn r\xf2 r\u1ec9 b\u1ed9 nh\u1edb. Do \u0111\xf3 ta ph\u1ea3i s\u1eed d\u1ee5ng ",(0,c.kt)("strong",{parentName:"p"},"cleanup function"))),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"Cleanup function")," gi\xfap ta \u201cd\u1ecdn d\u1eb9p\u201d c\xe1c logic ",(0,c.kt)("strong",{parentName:"li"},"side effects")," t\u1eeb l\u1ea7n render tr\u01b0\u1edbc tr\u01b0\u1edbc khi th\u1ef1c hi\u1ec7n ",(0,c.kt)("strong",{parentName:"li"},"side effects")," \u1edf l\u1ea7n render k\u1ebf ti\u1ebfp ho\u1eb7c khi component unmounted."),(0,c.kt)("li",{parentName:"ul"},"Ch\xfa \xfd r\u1eb1ng ",(0,c.kt)("strong",{parentName:"li"},"cleanup function LU\xd4N")," \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n tr\u01b0\u1edbc khi component re-render/unmounted, b\u1ea5t k\u1ec3 \u0111o\u1ea1n ",(0,c.kt)("strong",{parentName:"li"},"side effect")," c\xf3 \u0111o\u1ea1n code b\u1ea5t \u0111\u1ed3ng b\u1ed9")),(0,c.kt)("p",null,(0,c.kt)("img",{alt:"1695483718025",src:t(6212).Z,width:"1502",height:"173"})),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"C\xe1ch vi\u1ebft:")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},"useEffect(() => {\n  /* Code for side effects */\n  return () => {\n    /* Code for cleanup function */\n  };\n}, []);\n")),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"V\xed d\u1ee5 v\u1ec1 ",(0,c.kt)("strong",{parentName:"li"},"cleanup function")," :")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-tsx"},'useEffect(() => {\n  function handleScroll(e) {\n    console.log(e.clientX, e.clientY);\n  }\n  window.addEventListener("scroll", handleScroll);\n  return () => window.removeEventListener("scroll", handleScroll);\n}, []);\n')))}u.isMDXComponent=!0},6212:(n,e,t)=>{t.d(e,{Z:()=>r});const r=t.p+"assets/images/1695483718025-fb8e87b2840f971e1d8bcaa9da8f8c4e.png"}}]);